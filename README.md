# Kikyo Discord BOT

å¤šè§’è‰² Discord Bot ç³»çµ±ï¼Œæ”¯æ´ç¨ç«‹çš„è™›æ“¬äººç‰©è§’è‰²ï¼Œæ¯å€‹è§’è‰²éƒ½æœ‰å°ˆå±¬çš„ Discord Token å’Œè¨˜æ†¶ç³»çµ±ã€‚å…·å‚™ AI ç¾¤çµ„å°è©±è¿½è¹¤åŠŸèƒ½ï¼Œè®“ BOT èƒ½å¤ æ„ŸçŸ¥å¤šä½¿ç”¨è€…å°è©±ç’°å¢ƒä¸¦è‡ªç„¶åœ°èˆ‡æ‰€æœ‰åƒèˆ‡è€…äº’å‹•ã€‚

## ğŸš€ å¿«é€Ÿé–‹å§‹

å®Œæ•´å®‰è£æ–‡ä»¶ï¼šhttps://hackmd.io/@kikyoicecream/H1lydGdree

## ğŸ¯ ç³»çµ±ç‰¹è‰²

- ğŸ­ **å¤šè§’è‰²æ”¯æ´**ï¼šåŒæ™‚ Host å¤šå€‹ BOTï¼Œæ¨¡çµ„åŒ–æ–°å¢è§’è‰²
- ğŸ§  **Firestore è¨˜æ†¶ç³»çµ±**ï¼šä½¿ç”¨ Firestore å„²å­˜æ¯å€‹ä½¿ç”¨è€…çš„å°è©±è¨˜æ†¶
- ğŸ‘¥ **ç¾¤çµ„å°è©±è¿½è¹¤**ï¼šè¿½è¹¤æ´»èºä½¿ç”¨è€…ï¼Œæ”¯æ´å¤šä½¿ç”¨è€…ç¾¤çµ„å°è©±
- âœ¨ **è¡¨æƒ…ç¬¦è™Ÿå›æ‡‰**ï¼šä¾ç…§ä½¿ç”¨è€…å°è©±å…§å®¹ï¼Œè§¸ç™¼è¡¨æƒ…ç¬¦è™Ÿå›æ‡‰
- ğŸ”§ **é›²ç«¯é…ç½®ç®¡ç†**ï¼šæ‰€æœ‰è§’è‰²è¨­å®šã€æ¬Šé™ã€è¡¨æƒ…ç¬¦è™Ÿæ©Ÿç‡éƒ½å„²å­˜åœ¨ Firestore
- ğŸš€ **è‡ªå‹•é‡å•Ÿ**ï¼šBot ç•°å¸¸æ™‚è‡ªå‹•é‡å•ŸåŠŸèƒ½
- ğŸ”’ **å®‰å…¨éæ¿¾**ï¼šå…¨åŸŸ Gemini AI å®‰å…¨éæ¿¾å™¨ä¿è­·
- ğŸ¯ **æ–œç·šæŒ‡ä»¤**ï¼škeywordã€memoryã€restart ä¸‰ç¨®æ–œç·šæŒ‡ä»¤ï¼Œæ¯å€‹ BOT éƒ½æœ‰ç¨ç«‹çš„æŒ‡ä»¤
- âš¡ **ç°¡åŒ–çµæ§‹**ï¼šæ‰€æœ‰æ ¸å¿ƒæª”æ¡ˆéƒ½åœ¨æ ¹ç›®éŒ„ï¼Œæ˜“æ–¼ç¶­è­·

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
Kikyo Discord BOT/
â”œâ”€â”€ main.py                    # ä¸»ç¨‹å¼ - å¤š Bot å•Ÿå‹•å™¨
â”œâ”€â”€ character_bot.py           # è§’è‰² Bot æ ¸å¿ƒé‚è¼¯
â”œâ”€â”€ character_registry_custom.py  # è§’è‰²è¨»å†Šèˆ‡è¨­å®šç®¡ç†
â”œâ”€â”€ emoji_responses.py         # è¡¨æƒ…ç¬¦è™Ÿå›æ‡‰ç³»çµ±
â”œâ”€â”€ memory.py                  # Firestore è¨˜æ†¶ç®¡ç†
â”œâ”€â”€ group_conversation_tracker.py  # ç¾¤çµ„å°è©±è¿½è¹¤
â”œâ”€â”€ requirements.txt           # Python ä¾è³´å¥—ä»¶
â”œâ”€â”€ README.md                  # å°ˆæ¡ˆèªªæ˜æ–‡ä»¶
â””â”€â”€ .gitignore                 # Git å¿½ç•¥æª”æ¡ˆè¨­å®š
```

## ğŸ—„ï¸ Firestore è³‡æ–™åº«çµæ§‹

```
your-project/
â”œâ”€â”€ {character_id}/
â”‚   â”œâ”€â”€ profile/               # è§’è‰²è¨­å®šæª”
â”‚   â”œâ”€â”€ users/                 # ä½¿ç”¨è€…è¨˜æ†¶ï¼ˆå–®ä¸€æ–‡ä»¶ï¼‰
â”‚   â”‚   â””â”€â”€ {user_id}: []      # ä½¿ç”¨è€… ID å°æ‡‰è¨˜æ†¶é™£åˆ—
â”‚   â”œâ”€â”€ emoji_system/          # è¡¨æƒ…ç¬¦è™Ÿç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ general_emojis: []
â”‚   â”‚   â”œâ”€â”€ trigger_emojis: {}
â”‚   â”‚   â”œâ”€â”€ trigger_keywords: {}
â”‚   â”‚   â”œâ”€â”€ general_probability: 0.3
â”‚   â”‚   â””â”€â”€ server_probability: 0.2
â”‚   â””â”€â”€ system/                # ç³»çµ±é…ç½®
â”‚       â”œâ”€â”€ name: "{character_id}"
â”‚       â”œâ”€â”€ token_env: "{CHARACTER_ID}_TOKEN"
â”‚       â”œâ”€â”€ proactive_keywords: []
â”‚       â”œâ”€â”€ temperature: 1.0
â”‚       â”œâ”€â”€ top_k: 40
â”‚       â”œâ”€â”€ top_p: 0.9
â”‚       â”œâ”€â”€ enabled: true
â”‚       â”œâ”€â”€ allowed_guilds: []
â”‚       â””â”€â”€ allowed_channels: []
```

## ğŸ§  è¨˜æ†¶ç³»çµ±

- **è‡ªå‹•è¨˜æ†¶**ï¼šæ¯æ¬¡å°è©±å¾Œè‡ªå‹•ä½¿ç”¨ AI æå–é‡è¦è³‡è¨Š
- **æ™ºæ…§çµ±æ•´**ï¼šå‹•æ…‹è¨˜æ†¶è¶…é 15 å‰‡æ™‚ï¼Œè‡ªå‹•çµ±æ•´æˆæ‘˜è¦
- **è§’è‰²éš”é›¢**ï¼šæ¯å€‹è§’è‰²çš„è¨˜æ†¶å®Œå…¨ç¨ç«‹
- **ä½¿ç”¨è€…éš”é›¢**ï¼šæ¯å€‹ä½¿ç”¨è€…çš„è¨˜æ†¶åˆ†åˆ¥å„²å­˜åœ¨å–®ä¸€æ–‡ä»¶ä¸­

## ğŸ‘¥ ç¾¤çµ„å°è©±è¿½è¹¤åŠŸèƒ½

### åŠŸèƒ½æ¦‚è¿°
- **æ´»èºä½¿ç”¨è€…è¿½è¹¤**ï¼šè¨˜éŒ„å“ªäº›ä½¿ç”¨è€…æ­£åœ¨èˆ‡ BOT å°è©±
- **ç¾¤çµ„å°è©±ä¸Šä¸‹æ–‡**ï¼šäº†è§£æ•´å€‹å°è©±çš„è„ˆçµ¡
- **ä¸»å‹•æåŠå…¶ä»–ä½¿ç”¨è€…**ï¼šBOT å¯ä»¥è‡ªç„¶åœ°æåŠå…¶ä»–æ´»èºä½¿ç”¨è€…
- **AI å°è©±æ‘˜è¦**ï¼šç”Ÿæˆç¾¤çµ„å°è©±çš„æ‘˜è¦
- **BOT å›æ‡‰è¿½è¹¤**ï¼šè¨˜éŒ„ BOT è‡ªå·±çš„ç™¼è¨€ï¼Œç¢ºä¿å°è©±é€£çºŒæ€§

## ğŸ­ æ–œç·šæŒ‡ä»¤ç³»çµ±

### å¯ç”¨æŒ‡ä»¤

æ¯å€‹è§’è‰²éƒ½æœ‰ä»¥ä¸‹æ–œç·šæŒ‡ä»¤ï¼š

#### `/{character_prefix}_restart`
- **åŠŸèƒ½**ï¼šé‡æ–°å•Ÿå‹• Bot
- **ç¯„ä¾‹**ï¼š`/shen_ze_restart`ã€`/gu_beichen_restart`

#### `/{character_prefix}_keywords`
- **åŠŸèƒ½**ï¼šé¡¯ç¤ºè§’è‰²çš„ä¸»å‹•é—œéµå­—
- **ç¯„ä¾‹**ï¼š`/shen_ze_keywords`ã€`/gu_beichen_keywords`
- **é¡¯ç¤ºå…§å®¹**ï¼šè§’è‰²åç¨±å’Œå°æ‡‰çš„é—œéµå­—åˆ—è¡¨

#### `/{character_prefix}_memories`
- **åŠŸèƒ½**ï¼šé¡¯ç¤ºè§’è‰²èˆ‡ä½¿ç”¨è€…çš„è¨˜æ†¶å…§å®¹
- **ç¯„ä¾‹**ï¼š`/shen_ze_memories`ã€`/gu_beichen_memories`

## âš™ï¸ é…ç½®ç®¡ç†

### ç’°å¢ƒè®Šæ•¸è¨­å®š
åœ¨ `.env` æª”æ¡ˆä¸­è¨­å®šä»¥ä¸‹ç’°å¢ƒè®Šæ•¸ï¼š

```bash
# Discord Bot Token è¨­å®šï¼ˆå…¨å¤§å¯«ï¼‰
(CHARACTER_ID)_TOKEN=

# ç¯„ä¾‹ï¼š
# SHEN_ZE_TOKEN=
# GU_BEICHEN_TOKEN=
# FAN_CHENGXI_TOKEN=

# Google Gemini API è¨­å®š
GOOGLE_API_KEY=

# Firebase é‡‘é‘°ï¼Œå¿…é ˆæŠŠæ‰€æœ‰å…§å®¹æ”¾åœ¨åŒä¸€è¡Œ
FIREBASE_CREDENTIALS_JSON={"type": "service_account","project_id": ... ,"universe_domain": "googleapis.com"}
```

### Firestore é…ç½®
- **è§’è‰²è¨­å®š**ï¼šåœ¨ `/{character_id}/profile/` ä¸­è¨­å®šè§’è‰²è³‡æ–™
- **ç³»çµ±é…ç½®**ï¼šåœ¨ `/{character_id}/system/` ä¸­è¨­å®š Bot åƒæ•¸
- **è¡¨æƒ…ç¬¦è™Ÿ**ï¼šåœ¨ `/{character_id}/emoji_system/` ä¸­è¨­å®šè¡¨æƒ…ç¬¦è™Ÿå’Œæ©Ÿç‡
- **æ¬Šé™æ§åˆ¶**ï¼šåœ¨ `/{character_id}/system/` ä¸­è¨­å®š `allowed_guilds` å’Œ `allowed_channels`

## ğŸ”§ é–‹ç™¼èªªæ˜

### ç¨‹å¼ç¢¼ç‰¹è‰²
- **æ¨¡çµ„åŒ–è¨­è¨ˆ**ï¼šæ ¸å¿ƒåŠŸèƒ½åˆ†é›¢ï¼Œæ˜“æ–¼ç¶­è­·
- **é›²ç«¯é…ç½®**ï¼šæ‰€æœ‰è¨­å®šéƒ½å„²å­˜åœ¨ Firestoreï¼Œç„¡éœ€ä¿®æ”¹ç¨‹å¼ç¢¼
- **éŒ¯èª¤è™•ç†**ï¼šå®Œæ•´çš„ç•°å¸¸è™•ç†æ©Ÿåˆ¶
- **æ—¥èªŒè¨˜éŒ„**ï¼šè©³ç´°çš„é‹è¡Œæ—¥èªŒ
- **ç°¡åŒ–çµæ§‹**ï¼šç§»é™¤ core è³‡æ–™å¤¾ï¼Œæ‰€æœ‰æª”æ¡ˆéƒ½åœ¨æ ¹ç›®éŒ„

## ğŸ“‹ ç’°å¢ƒéœ€æ±‚

- **Python 3.9+**
- **Discord.py >= 2.3.0**
- **Firebase Admin SDK >= 6.0.0**
- **Google Generative AI == 0.8.3**
- **å…¶ä»–ç›¸ä¾å¥—ä»¶**è«‹åƒè€ƒ `requirements.txt`

## æˆæ¬Š
æ­¤å°ˆæ¡ˆåƒ…ä¾›å€‹äººä½¿ç”¨å’Œå­¸ç¿’ç›®çš„ã€‚